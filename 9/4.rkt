#lang racket

(define (to-morse str)
  (define morse-codes
    '((#\A . "._ ") (#\B . "_... ") (#\C . "_._. ") (#\D . "_.. ") (#\E . ". ") (#\F . ".._. ")
      (#\G . "__. ") (#\H . ".... ") (#\I . ".. ") (#\J . ".___ ") (#\K . "_._ ") (#\L . "._.. ")
      (#\M . "__ ") (#\N . "_. ") (#\O . "___ ") (#\P . ".__. ") (#\Q . "__._ ") (#\R . "._. ")
      (#\S . "... ") (#\T . "_ ") (#\U . ".._ ") (#\V . "..._ ") (#\W . ".__ ") (#\X . "_.._ ")
      (#\Y . "_.__ ") (#\Z . "__.. ")
      (#\a . "._ ") (#\b . "_... ") (#\c . "_._. ") (#\d . "_.. ") (#\e . ". ") (#\f . ".._. ")
      (#\g . "__. ") (#\h . ".... ") (#\i . ".. ") (#\j . ".___ ") (#\k . "_._ ") (#\l . "._.. ")
      (#\m . "__ ") (#\n . "_. ") (#\o . "___ ") (#\p . ".__. ") (#\q . "__._ ") (#\r . "._. ")
      (#\s . "... ") (#\t . "_ ") (#\u . ".._ ") (#\v . "..._ ") (#\w . ".__ ") (#\x . "_.._ ")
      (#\y . "_.__ ") (#\z . "__.. ")
      (#\0 . "_____ ") (#\1 . ".____ ") (#\2 . "..___ ") (#\3 . "...__ ")
      (#\4 . "...._ ") (#\5 . "..... ") (#\6 . "_.... ") (#\7 . "__... ")
      (#\8 . "___.. ") (#\9 . "____. ")
      (#\. . "._._._ ") (#\_ . "_ ") (#\  . "  ")))
  
  (define (char->morse char)
    (cdr (assoc char morse-codes)))
  
  (define (words->morse words)
    (map (lambda (word)
           (string-append (apply string-append (map char->morse (string->list word))) " "))
         (string-split words)))
  
  (apply string-append (words->morse str))) 

